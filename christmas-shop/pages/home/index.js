const data = {
    "items": [
        {
            "name": "Bug Magnet",
            "description": "Able to find bugs in code like they were placed there on purpose.",
            "img": "../../assets/images/gift-for-work.png",
            "class": "for-work",
            "category": "For Work",
            "superpowers": {
                "live": "+500",
                "create": "+500",
                "love": "+200",
                "dream": "+400"
            }
        },

        {
            "name": "Console.log Guru",
            "description": "Uses console.log like a crystal ball to find any issue.",
            "img": "../../assets/images/gift-for-work.png",
            "class": "for-work",
            "category": "For Work",
            "superpowers": {
                "live": "+500",
                "create": "+500",
                "love": "+200",
                "dream": "+400"
            }
        },

        {
            "name": "Shortcut Cheater",
            "description": "Knows every keyboard shortcut like they were born with them.",
            "img": "../../assets/images/gift-for-work.png",
            "class": "for-work",
            "category": "For Work",
            "superpowers": {
                "live": "+500",
                "create": "+500",
                "love": "+400",
                "dream": "+200"
            }
        },

        {
            "name": "Merge Master",
            "description": "Merges branches in Git without conflicts, like a wizard during an exam.",
            "img": "../../assets/images/gift-for-work.png",
            "class": "for-work",
            "category": "For Work",
            "superpowers": {
                "live": "+200",
                "create": "+500",
                "love": "+200",
                "dream": "+300"
            }
        },

        {
            "name": "Async Tamer",
            "description": "Handles asynchronous code and promises like well-trained pets.",
            "img": "../../assets/images/gift-for-work.png",
            "class": "for-work",
            "category": "For Work",
            "superpowers": {
                "live": "+100",
                "create": "+400",
                "love": "+200",
                "dream": "+300"
            }
        },

        {
            "name": "CSS Tamer",
            "description": "Can make Flexbox and Grid work together like they were always best friends.",
            "img": "../../assets/images/gift-for-work.png",
            "class": "for-work",
            "category": "For Work",
            "superpowers": {
                "live": "+200",
                "create": "+500",
                "love": "+200",
                "dream": "+300"
            }
        },

        {
            "name": "Time Hacker",
            "description": "Writes code at the last moment but always meets the deadline.",
            "img": "../../assets/images/gift-for-work.png",
            "class": "for-work",
            "category": "For Work",
            "superpowers": {
                "live": "+500",
                "create": "+500",
                "love": "+500",
                "dream": "+200"
            }
        },

        {
            "name": "Layout Master",
            "description": "Creates perfect layouts on the first try, like they can read the designer's mind.",
            "img": "../../assets/images/gift-for-work.png",
            "class": "for-work",
            "category": "For Work",
            "superpowers": {
                "live": "+500",
                "create": "+300",
                "love": "+200",
                "dream": "+200"
            }
        },

        {
            "name": "Documentation Whisperer",
            "description": "Understands cryptic documentation as if they wrote it themselves.",
            "img": "../../assets/images/gift-for-work.png",
            "class": "for-work",
            "category": "For Work",
            "superpowers": {
                "live": "+500",
                "create": "+500",
                "love": "+200",
                "dream": "+100"
            }
        },

        {
            "name": "Feedback Master",
            "description": "Accepts client revisions with the Zen calm of Buddha.",
            "img": "../../assets/images/gift-for-work.png",
            "class": "for-work",
            "category": "For Work",
            "superpowers": {
                "live": "+300",
                "create": "+500",
                "love": "+300",
                "dream": "+400"
            }
        },

        {
            "name": "Code Minimalist",
            "description": "Writes code so concise that one line does more than a whole file.",
            "img": "../../assets/images/gift-for-work.png",
            "class": "for-work",
            "category": "For Work",
            "superpowers": {
                "live": "+500",
                "create": "+500",
                "love": "+500",
                "dream": "+200"
            }
        },

        {
            "name": "Pixel-Perfect Magician",
            "description": "Aligns elements to the last pixel, even when the design looks abstract.",
            "img": "../../assets/images/gift-for-work.png",
            "class": "for-work",
            "category": "For Work",
            "superpowers": {
                "live": "+500",
                "create": "+500",
                "love": "+400",
                "dream": "+400"
            }
        },

        {
            "name": "Posture Levitation",
            "description": "Can sit for hours, but maintains perfect posture like a ballerina.",
            "img": "../../assets/images/gift-for-health.png",
            "class": "for-health",
            "category": "For Health",
            "superpowers": {
                "live": "+400",
                "create": "+500",
                "love": "+500",
                "dream": "+400"
            }
        },

        {
            "name": "Step Master",
            "description": "Gets 10,000 steps a day even while sitting at the computer.",
            "img": "../../assets/images/gift-for-health.png",
            "class": "for-health",
            "category": "For Health",
            "superpowers": {
                "live": "+400",
                "create": "+300",
                "love": "+500",
                "dream": "+400"
            }
        },

        {
            "name": "Snack Resister",
            "description": "Ignoring desktop snacks like a strict dietician.",
            "img": "../../assets/images/gift-for-health.png",
            "class": "for-health",
            "category": "For Health",
            "superpowers": {
                "live": "+400",
                "create": "+100",
                "love": "+200",
                "dream": "+400"
            }
        },

        {
            "name": "Hydration Bot",
            "description": "Drinks the recommended 2 liters of water a day like a health-programmed robot.",
            "img": "../../assets/images/gift-for-health.png",
            "class": "for-health",
            "category": "For Health",
            "superpowers": {
                "live": "+500",
                "create": "+300",
                "love": "+500",
                "dream": "+500"
            }
        },

        {
            "name": "Sleep Overlord",
            "description": "Sleeps 6 hours but feels like they had 10.",
            "img": "../../assets/images/gift-for-health.png",
            "class": "for-health",
            "category": "For Health",
            "superpowers": {
                "live": "+400",
                "create": "+500",
                "love": "+500",
                "dream": "+500"
            }
        },

        {
            "name": "Break Guru",
            "description": "Takes a stretch break every hour without forgetting, no matter how focused.",
            "img": "../../assets/images/gift-for-health.png",
            "class": "for-health",
            "category": "For Health",
            "superpowers": {
                "live": "+300",
                "create": "+300",
                "love": "+300",
                "dream": "+400"
            }
        },

        {
            "name": "Eye Protector",
            "description": "Can work all day at the monitor without feeling like their eyes are on fire.",
            "img": "../../assets/images/gift-for-health.png",
            "class": "for-health",
            "category": "For Health",
            "superpowers": {
                "live": "+100",
                "create": "+300",
                "love": "+500",
                "dream": "+400"
            }
        },

        {
            "name": "Stress Dodger",
            "description": "Masters meditation right at the keyboard.",
            "img": "../../assets/images/gift-for-health.png",
            "class": "for-health",
            "category": "For Health",
            "superpowers": {
                "live": "+100",
                "create": "+400",
                "love": "+200",
                "dream": "+400"
            }
        },

        {
            "name": "Yoga Coder",
            "description": "Easily switches from coding to yoga and back.",
            "img": "../../assets/images/gift-for-health.png",
            "class": "for-health",
            "category": "For Health",
            "superpowers": {
                "live": "+400",
                "create": "+400",
                "love": "+400",
                "dream": "+400"
            }
        },

        {
            "name": "Healthy Snacker",
            "description": "Always picks fruit, even when chocolate is within armâ€™s reach.",
            "img": "../../assets/images/gift-for-health.png",
            "class": "for-health",
            "category": "For Health",
            "superpowers": {
                "live": "+400",
                "create": "+300",
                "love": "+200",
                "dream": "+400"
            }
        },

        {
            "name": "Chair Exerciser",
            "description": "Manages to work out without leaving the chair.",
            "img": "../../assets/images/gift-for-health.png",
            "class": "for-health",
            "category": "For Health",
            "superpowers": {
                "live": "+500",
                "create": "+500",
                "love": "+500",
                "dream": "+400"
            }
        },

        {
            "name": "Caffeine Filter",
            "description": "Drinks coffee at night and still falls asleep with no problem.",
            "img": "../../assets/images/gift-for-health.png",
            "class": "for-health",
            "category": "For Health",
            "superpowers": {
                "live": "+400",
                "create": "+300",
                "love": "+500",
                "dream": "+200"
            }
        },

        {
            "name": "Joy Charger",
            "description": "Finds joy in the little thingsâ€”even in a build that finishes unexpectedly fast.",
            "img": "../../assets/images/gift-for-harmony.png",
            "class": "for-harmony",
            "category": "For Harmony",
            "superpowers": {
                "live": "+200",
                "create": "+200",
                "love": "+500",
                "dream": "+500"
            }
        },

        {
            "name": "Error Laugher",
            "description": "Laughs at code errors like theyâ€™re jokes instead of getting angry.",
            "img": "../../assets/images/gift-for-harmony.png",
            "class": "for-harmony",
            "category": "For Harmony",
            "superpowers": {
                "live": "+300",
                "create": "+200",
                "love": "+500",
                "dream": "+500"
            }
        },

        {
            "name": "Bug Acceptance Guru",
            "description": "Accepts bugs as part of the journey to perfection â€” itâ€™s just another task.",
            "img": "../../assets/images/gift-for-harmony.png",
            "class": "for-harmony",
            "category": "For Harmony",
            "superpowers": {
                "live": "+300",
                "create": "+200",
                "love": "+500",
                "dream": "+400"
            }
        },

        {
            "name": "Spontaneous Coding Philosopher",
            "description": "Philosophically accepts any client suggestion after a long refactor.",
            "img": "../../assets/images/gift-for-harmony.png",
            "class": "for-harmony",
            "category": "For Harmony",
            "superpowers": {
                "live": "+300",
                "create": "+200",
                "love": "+500",
                "dream": "+400"
            }
        },

        {
            "name": "Deadline Sage",
            "description": "Remains zen even when the deadline is close and the project manager is stressed.",
            "img": "../../assets/images/gift-for-harmony.png",
            "class": "for-harmony",
            "category": "For Harmony",
            "superpowers": {
                "live": "+200",
                "create": "+200",
                "love": "+300",
                "dream": "+500"
            }
        },

        {
            "name": "Inspiration Maestro",
            "description": "Finds inspiration on an empty screen as if masterpieces are already there.",
            "img": "../../assets/images/gift-for-harmony.png",
            "class": "for-harmony",
            "category": "For Harmony",
            "superpowers": {
                "live": "+300",
                "create": "+200",
                "love": "+400",
                "dream": "+100"
            }
        },

        {
            "name": "Peace Keeper",
            "description": "Maintains inner calm even in moments of intense crisis.",
            "img": "../../assets/images/gift-for-harmony.png",
            "class": "for-harmony",
            "category": "For Harmony",
            "superpowers": {
                "live": "+200",
                "create": "+200",
                "love": "+500",
                "dream": "+500"
            }
        },

        {
            "name": "Empathy Guru",
            "description": "Feels the teamâ€™s mood and can lift everyoneâ€™s spirits.",
            "img": "../../assets/images/gift-for-harmony.png",
            "class": "for-harmony",
            "category": "For Harmony",
            "superpowers": {
                "live": "+500",
                "create": "+200",
                "love": "+500",
                "dream": "+500"
            }
        },

        {
            "name": "Laughter Generator",
            "description": "Can lighten any tense situation with a joke that even bugs laugh at.",
            "img": "../../assets/images/gift-for-harmony.png",
            "class": "for-harmony",
            "category": "For Harmony",
            "superpowers": {
                "live": "+300",
                "create": "+200",
                "love": "+200",
                "dream": "+500"
            }
        },

        {
            "name": "Pause Master",
            "description": "Knows when to just step back from the keyboard and breathe.",
            "img": "../../assets/images/gift-for-harmony.png",
            "class": "for-harmony",
            "category": "For Harmony",
            "superpowers": {
                "live": "+300",
                "create": "+200",
                "love": "+100",
                "dream": "+100"
            }
        },

        {
            "name": "Coder Healer",
            "description": "Can support a colleague in their darkest hour, even if itâ€™s a 500 error.",
            "img": "../../assets/images/gift-for-harmony.png",
            "class": "for-harmony",
            "category": "For Harmony",
            "superpowers": {
                "live": "+300",
                "create": "+200",
                "love": "+500",
                "dream": "+500"
            }
        },

        {
            "name": "Music Code Curator",
            "description": "Creates work playlists so good, even deadlines follow the rhythm.",
            "img": "../../assets/images/gift-for-harmony.png",
            "class": "for-harmony",
            "category": "For Harmony",
            "superpowers": {
                "live": "+300",
                "create": "+200",
                "love": "+300",
                "dream": "+200"
            }
        }
    ]
}

const burger = document.querySelector(".burger");
const menu = document.querySelector(".mobile-menu");
const menuLinks = document.querySelectorAll(".mobile-nav-item");
const body = document.querySelector("body");
const bestCards = document.querySelector('.best-cards');
const backgroundPopap = document.querySelector(".no-scroll-background");
const popap = document.querySelector(".popap");
const daysElement = document.querySelector('.cta-calendar-days .cta-digital');
const hoursElement = document.querySelector('.cta-calendar-hours .cta-digital');
const minutesElement = document.querySelector('.cta-calendar-minutes .cta-digital');
const secondsElement = document.querySelector('.cta-calendar-seconds .cta-digital');
const sliderList = document.querySelector('.slider-list');
const prevButton = document.querySelector('.prev-paginator');
const nextButton = document.querySelector('.next-paginator');
const totalSlides = document.querySelectorAll('.slider-item').length;
const slider = document.querySelector('.slider');
let sliderWidth = slider.offsetWidth;
let currentIndex = 0;
let slideWidth = 0;
let screenWidth = 0;
let slideScreenWidth = 0;

/* ======= Slider ======= */

// Function to update the slider shift based on the screen width
function updateSlidesToMove() {
    screenWidth = sliderList.offsetWidth;
    sliderWidth = slider.offsetWidth;
    slideScreenWidth = 1993 - screenWidth;
    if (sliderWidth > 768) {
        slideWidth = slideScreenWidth / 3;
    } else {
        slideWidth = slideScreenWidth / 6;
    }
}

// Function to update the button states
function updateButtonsState() {
    if (currentIndex < slideWidth - 1) {
        prevButton.classList.add('inactive');
    } else {
        prevButton.classList.remove('inactive');
    }
    if (currentIndex >= slideScreenWidth) {
        nextButton.classList.add('inactive');
    } else {
        nextButton.classList.remove('inactive');
    }
}

// Function to shift the slider by a specified number of pixels
function moveSlider(direction) {
    if (direction === 'next') {
        currentIndex += slideWidth;
    } else if (direction === 'prev') {
        currentIndex -= slideWidth;
    }
    if (currentIndex < 0) {
        currentIndex = 0;
    }
    sliderList.style.transform = `translateX(-${currentIndex}px)`;
    updateButtonsState();
}

// Event handlers for the buttons
nextButton.addEventListener('click', () => {
    moveSlider('next');
});

prevButton.addEventListener('click', () => {
    moveSlider('prev');
});

// Window resize event handler
window.addEventListener('resize', () => {
    updateSlidesToMove();
    currentIndex = 0;
    sliderList.style.transform = `translateX(0)`;
    updateButtonsState();
});

updateSlidesToMove();
updateButtonsState();

/* ======= Menu ======= */

// Function to toggle the state of the menu and background
function toggleMenu() {
    burger.classList.toggle("rotate");
    menu.classList.toggle("open");
    if (menu.classList.contains("open")) {
        body.classList.add("no-scroll");
    } else {
        body.classList.remove("no-scroll");
    }
}

// Click event handler for the burger menu
burger.addEventListener("click", toggleMenu);

// Click event handlers for the menu links
menuLinks.forEach(function (link) {
    link.addEventListener("click", function () {
        if (menu.classList.contains("open")) {
            toggleMenu();
        }
    });
});


/* ======= Best Cards ======= */

// Function to shuffle the array
function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

// Function to duplicate data in order to shuffle the array
function prepareData() {
    const duplicatedItems = [];
    duplicatedItems.push(...(shuffle([...data.items])));
    data.items = duplicatedItems;
    console.log(data.items.name);
}

//Function to populate the cards
function populateBestCards() {
    prepareData();
    bestCards.innerHTML = '';

    for (let i = 0; i < 4; i++) {
        let index = i % data.items.length;
        const card = document.createElement('div');
        card.className = 'best-card';
        card.innerHTML = `
        <div class="best-card-image"><img src="${data.items[index].img}" alt="${data.items[index].category}"></div>
        <div class="best-card-description">
            <div class="best-card-title ${data.items[index].class} text">${data.items[index].category}</div>
             <h4 class="best-card-subtitle">${data.items[index].name}</h4>
         </div>
        `;
        bestCards.appendChild(card);
    }
    populatePopap();
}

// Page load event handler
window.addEventListener('load', populateBestCards);

/* ======= Popap ======= */


// Function to toggle the state of the popup and background
function togglePopap() {
    popap.classList.toggle("open");
    backgroundPopap.classList.toggle("open");
    if (popap.classList.contains("open")) {
        body.classList.add("no-scroll");
    } else {
        body.classList.remove("no-scroll");
    }
}

// Function to populate the popup
function populatePopap() {
    const cards = document.querySelectorAll(".best-card");
    cards.forEach(card => {
        card.addEventListener('click', function () {
            const nameElement = card.querySelector(".best-card-subtitle");
            const cardName = nameElement.textContent;

            for (let item of data.items) {
                if (item.name === cardName) {

                    // Function to create superpower images
                    function generateSuperpowerImages(count) {
                        const container = document.createElement('div');
                        container.className = 'superpower-imgages';
                        for (let i = 0; i < count; i++) {
                            const img = document.createElement('img');
                            img.src = '../../assets/images/snowflake.png';
                            img.alt = 'snowflake';
                            img.className = 'superpower-img';
                            container.appendChild(img);
                        }
                        return container.innerHTML;
                    }

                    popap.innerHTML = `
                    <div class="popap-close">
                        <div class="popap-close-img"></div>
                        <div class="popap-close-img"></div>
                    </div>
                    <div class="popap-image"><img src="${item.img}" alt="${item.category}"></div>
                    <div class="popap-text">
                        <div class="popap-info">
                            <div class="popap-title ${item.class} text">${item.category}</div>
                            <h4 class="popap-subtitle">${item.name}</h4>
                            <div class="popap-description">${item.description}</div>
                        </div>
                        <div class="popap-superpowers">
                            <div class="superpower-title text">Adds superpowers to:</div>
                            <div class="superpower">
                                <div class="superpower-name">Live</div>
                                <div class="superpower-digit">${item.superpowers.live}</div>
                                <div class="superpower-imgages">
                                ${generateSuperpowerImages(parseInt(item.superpowers.live.replace('+', ''), 10) / 100)}
                                </div>
                            </div>
                            <div class="superpower">
                                <div class="superpower-name">Create</div>
                                <div class="superpower-digit">${item.superpowers.create}</div>
                                <div class="superpower-imgages">
                                ${generateSuperpowerImages(parseInt(item.superpowers.create.replace('+', ''), 10) / 100)}
                                </div>
                            </div>
                            <div class="superpower">
                                <div class="superpower-name">Love</div>
                                <div class="superpower-digit">${item.superpowers.love}</div>
                                <div class="superpower-imgages">
                                ${generateSuperpowerImages(parseInt(item.superpowers.love.replace('+', ''), 10) / 100)}
                                </div>
                            </div>
                            <div class="superpower">
                                <div class="superpower-name">Dream</div>
                                <div class="superpower-digit">${item.superpowers.dream}</div>
                                <div class="superpower-imgages">
                                ${generateSuperpowerImages(parseInt(item.superpowers.dream.replace('+', ''), 10) / 100)}
                                </div>
                            </div>
                        </div>
                    </div>
            `;
                }
            }
            togglePopap();

            // Click event handler for the close button
            const close = document.querySelector(".popap-close");
            close.addEventListener("click", togglePopap);
        });
    });
}

// Click event handler for the background
backgroundPopap.addEventListener("click", function (event) {
    if (!popap.contains(event.target) && popap.classList.contains("open")) {
        togglePopap();
    }
});

populateBestCards();

/* ======= Timer ======= */

function updateCountdown() {
    const nextNewYear = new Date(Date.UTC(new Date().getUTCFullYear() + 1, 0, 1, 0, 0, 0, 0));
    const now = new Date();
    const timeDifference = nextNewYear - now;

    if (timeDifference > 0) {
        const totalSeconds = Math.floor(timeDifference / 1000);
        const days = Math.floor(totalSeconds / (3600 * 24));
        const hours = Math.floor((totalSeconds % (3600 * 24)) / 3600);
        const minutes = Math.floor((totalSeconds % 3600) / 60);
        const seconds = totalSeconds % 60;

        daysElement.textContent = days;
        hoursElement.textContent = hours;
        minutesElement.textContent = minutes;
        secondsElement.textContent = seconds;
    } else {
        daysElement.textContent = 0;
        hoursElement.textContent = 0;
        minutesElement.textContent = 0;
        secondsElement.textContent = 0;
    }
}

setInterval(updateCountdown, 1000);
updateCountdown();
